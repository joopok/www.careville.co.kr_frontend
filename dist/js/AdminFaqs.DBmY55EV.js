import{j as e}from"./ui-vendor.Cr0a_QLz.js";import{r as s}from"./react-vendor.DLPRJx9T.js";import{C as a}from"./card.Bta0xwCM.js";import{B as t}from"./button.CwQkHdGN.js";import{I as r,T as i}from"./textarea.STgdp43p.js";import{L as n}from"./label.DYPORF4U.js";import"./index.Bw955bGW.js";import"./utils.DMNqCBYd.js";const c=()=>{const[c,l]=s.useState([]),[o,d]=s.useState(!0),[h,m]=s.useState(null),[x,j]=s.useState({question:"",answer:"",category:"",order:0,display:!0}),[p,u]=s.useState(null),y=s.useMemo(()=>"http://ksm1779.cafe24.com",[]),f=async()=>{try{d(!0);const e=await fetch(`${y}/api/faqs`);if(!e.ok)throw new Error("목록 조회 실패");const s=await e.json();l(s.data||[])}catch(e){m(e instanceof Error?e.message:"오류 발생")}finally{d(!1)}};s.useEffect(()=>{f()},[]);const g=()=>{j({question:"",answer:"",category:"",order:0,display:!0}),u(null)};return e.jsx("div",{className:"min-h-screen bg-background",children:e.jsxs("div",{className:"container mx-auto px-6 py-10",children:[e.jsx("h1",{className:"text-2xl font-bold mb-6",children:"FAQ 관리"}),e.jsxs(a,{className:"p-6 mb-8",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(n,{children:"질문"}),e.jsx(r,{value:x.question||"",onChange:e=>j(s=>({...s,question:e.target.value})),placeholder:"질문 입력"})]}),e.jsxs("div",{children:[e.jsx(n,{children:"카테고리(선택)"}),e.jsx(r,{value:x.category||"",onChange:e=>j(s=>({...s,category:e.target.value})),placeholder:"예: 결제, 예약"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(n,{children:"답변"}),e.jsx(i,{value:x.answer||"",onChange:e=>j(s=>({...s,answer:e.target.value})),rows:4,placeholder:"답변 입력"})]}),e.jsxs("div",{children:[e.jsx(n,{children:"표시 순서"}),e.jsx(r,{type:"number",value:x.order??0,onChange:e=>j(s=>({...s,order:Number(e.target.value)}))})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{id:"display",type:"checkbox",checked:x.display??!0,onChange:e=>j(s=>({...s,display:e.target.checked}))}),e.jsx(n,{htmlFor:"display",children:"노출"})]})]}),e.jsxs("div",{className:"mt-4 flex gap-2",children:[e.jsx(t,{onClick:async()=>{try{if(!x.question||!x.answer)return alert("질문/답변을 입력하세요");const e={...x,order:Number(x.order)||0},s=p?`${y}/api/faqs/${p}`:`${y}/api/faqs`,a=p?"PUT":"POST",t={"Content-Type":"application/json"};let r=await fetch(s,{method:a,headers:t,body:JSON.stringify(e)});if(!r.ok&&(403===r.status||415===r.status||405===r.status)){const a=new URLSearchParams;Object.entries(e).forEach(([e,s])=>a.set(e,String(s??""))),r=await fetch(s,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:a.toString()})}if(!r.ok)throw new Error("저장 실패");await f(),g()}catch(e){alert(e instanceof Error?e.message:"오류 발생")}},children:p?"수정하기":"등록하기"}),p&&e.jsx(t,{variant:"outline",onClick:g,children:"취소"})]})]}),e.jsx(a,{className:"p-6",children:o?e.jsx("div",{children:"불러오는 중…"}):h?e.jsx("div",{className:"text-red-500",children:h}):0===c.length?e.jsx("div",{children:"등록된 항목이 없습니다."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left border-b",children:[e.jsx("th",{className:"py-2",children:"순서"}),e.jsx("th",{className:"py-2",children:"질문"}),e.jsx("th",{className:"py-2",children:"카테고리"}),e.jsx("th",{className:"py-2",children:"노출"}),e.jsx("th",{className:"py-2 w-40",children:"작업"})]})}),e.jsx("tbody",{children:c.map(s=>e.jsxs("tr",{className:"border-b hover:bg-muted/30",children:[e.jsx("td",{className:"py-2",children:s.order??0}),e.jsx("td",{className:"py-2 max-w-xl truncate",title:s.question,children:s.question}),e.jsx("td",{className:"py-2",children:s.category||"-"}),e.jsx("td",{className:"py-2",children:!1===s.display?"숨김":"노출"}),e.jsxs("td",{className:"py-2 flex gap-2",children:[e.jsx(t,{size:"sm",variant:"outline",onClick:()=>{u(s.id),j({question:s.question,answer:s.answer,category:s.category,order:s.order,display:!1!==s.display})},children:"수정"}),e.jsx(t,{size:"sm",variant:"destructive",onClick:()=>(async e=>{if(confirm("삭제하시겠습니까?"))try{const s=`${y}/api/faqs/${e}`;let a=await fetch(s,{method:"DELETE"});if(a.ok||403!==a.status&&405!==a.status||(a=await fetch(s,{method:"POST"})),!a.ok)throw new Error("삭제 실패");await f()}catch(s){alert(s instanceof Error?s.message:"오류 발생")}})(s.id),children:"삭제"})]})]},s.id))})]})})})]})})};export{c as default};
